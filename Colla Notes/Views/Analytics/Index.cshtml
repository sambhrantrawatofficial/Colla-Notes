@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{
    var Username = HttpContextAccessor.HttpContext.Session.GetString("username");
}
﻿@using System.Text.RegularExpressions
@model List<Post>
@{
}
<!-- Mobile Menu Toggle -->
<button id="menuToggle"
        class="fixed top-4 left-4 z-[1100] bg-white border-0 p-3 rounded-lg shadow-md
               cursor-pointer flex items-center justify-center md:hidden">
    <div class="w-6 h-6 flex flex-col justify-around">
        <span class="menu-line w-full h-0.5 bg-[#2C3E50] rounded-sm transition-all duration-300"></span>
        <span class="menu-line w-full h-0.5 bg-[#2C3E50] rounded-sm transition-all duration-300"></span>
        <span class="menu-line w-full h-0.5 bg-[#2C3E50] rounded-sm transition-all duration-300"></span>
    </div>
</button>

<!-- Overlay -->
<div id="overlay"
     class="hidden fixed top-0 left-0 w-full h-full bg-black/50 z-[999]"></div>
<aside id="sidebar"
       class="fixed top-0 left-0 w-full h-screen
              bg-gradient-to-b from-[#A8E6CF] to-[#7FD4B8]
              p-6 shadow-lg overflow-y-auto z-[1000]
              -translate-x-full transition-transform duration-300
              md:w-1/4 md:translate-x-0
              lg:w-[22%] xl:w-[20%]">

    <!-- Logo -->
    <div class="mb-10 flex items-center gap-3">
        <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center">
            <div class="w-8 h-8 bg-gradient-to-br from-[#5DADE2] to-[#3498DB] rounded-lg"></div>
        </div>
        <h2 class="text-xl font-bold text-[#2C3E50]">Colla Notes</h2>
    </div>

    <!-- Navigation -->
    <nav class="space-y-2">
        <a class="nav-btn block w-full text-left px-4 py-3 rounded-xl border-0 bg-transparent cursor-pointer text-base font-medium text-[#2C3E50] transition-all duration-200 hover:bg-white/50 no-underline"
           asp-action="Index" asp-controller="Home">Home</a>
        <a class="nav-btn block w-full text-left px-4 py-3 rounded-xl border-0 bg-transparent cursor-pointer text-base font-medium text-[#2C3E50] transition-all duration-200 hover:bg-white/50 no-underline"
            asp-action="Index" asp-controller="Profile">Profile</a>
        <a class="nav-btn block w-full text-left px-4 py-3 rounded-xl border-0 bg-transparent cursor-pointer text-base font-medium text-[#2C3E50] transition-all duration-200 hover:bg-white/50 no-underline"
           asp-action="PostHome" asp-controller="Posts">My Posts</a>
        <a class="nav-btn block w-full text-left px-4 py-3 rounded-xl border-0 bg-white shadow-md cursor-pointer text-base font-medium text-[#2C3E50] transition-all duration-200 no-underline"
            asp-action="Index" asp-controller="Analytics">Analytics</a>
        <a class="nav-btn block w-full text-left px-4 py-3 rounded-xl border-0 bg-transparent text-base font-medium text-[#2C3E50] pointer-events-none select-none no-underline"
           style="outline: none !important; box-shadow: none !important; background-color: transparent !important;">
            @Username
        </a>
    </nav>
</aside>

<!--=============================================Main============================================================-->
<main class="w-full min-h-screen p-4 ml-0 pb-24 transition-all duration-300
         sm:p-6 md:w-3/4 md:ml-[25%]
         md:p-8 lg:w-[78%] lg:ml-[22%]
         xl:w-[80%] xl:ml-[20%]">

    <!-- Header -->
    <div class="mb-8 mt-6">

        <div class="flex items-center space-x-3 text-2xl md:text-3xl font-bold text-gray-600">
            <a asp-action="Index" asp-controller="Home"
               class="hover:text-gray-900 transition-colors duration-200">
                Dashboard
            </a>
            <span class="text-gray-400">/</span>
            <a href="/Analytics/Index"
               class="text-gray-800 hover:text-black transition-colors duration-200">
                Analytics
            </a>
        </div>

        <h1 class="mt-4 flex items-center gap-3 text-2xl md:text-3xl font-extrabold tracking-tight text-gray-700">
            <span>Post Analytics Overview</span>
            <span class="text-2xl md:text-3xl">📊</span>
        </h1>
    </div>


    <!-- Stats Cards -->
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="card border-0 shadow-lg text-center rounded-4 h-100">
                <div class="card-body py-4">
                    <h6 class="text-muted mb-1">Total Posts</h6>
                    <h2 class="fw-bold text-primary">@ViewBag.TotalPosts</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-0 shadow-lg text-center rounded-4 h-100">
                <div class="card-body py-4">
                    <h6 class="text-muted mb-1">Total Views</h6>
                    <h2 class="fw-bold text-success">@ViewBag.TotalViews</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-0 shadow-lg text-center rounded-4 h-100">
                <div class="card-body py-4">
                    <h6 class="text-muted mb-1">Total Likes</h6>
                    <h2 class="fw-bold text-danger">@ViewBag.TotalLikes</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card border-0 shadow-lg text-center rounded-4 h-100">
                <div class="card-body py-4">
                    <h6 class="text-muted mb-1">Total Comments</h6>
                    <h2 class="fw-bold text-warning">@ViewBag.TotalComments</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- Table Card -->
    <div class="card border-0 shadow-lg rounded-4">
        <div class="card-body p-4">

            <h5 class="fw-bold mb-4 d-flex align-items-center gap-2">
                📈 Detailed Post Analytics
            </h5>

            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-dark text-white rounded-top">
                        <tr>
                            <th class="py-3">Title</th>
                            <th class="py-3 text-center">Views</th>
                            <th class="py-3 text-center">Likes</th>
                            <th class="py-3 text-center">Comments</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var post in Model)
                        {
                            <tr class="border-bottom">
                                <td class="fw-semibold">@post.Title</td>
                                <td class="text-center">@post.ViewCount</td>
                                <td class="text-center">@post.LikeCount</td>
                                <td class="text-center">
                                    @(string.IsNullOrEmpty(post.Comments)
                                                                    ? 0
                                                                    : post.Comments.Split("||").Length)
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            @if (!Model.Any())
            {
                <p class="text-muted text-center mt-4">
                    No posts found.
                </p>
            }

        </div>
    </div>

</main>



<script>
    const toggleBtn = document.getElementById("menuToggle");
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");

    toggleBtn.addEventListener("click", () => {
        sidebar.classList.toggle("-translate-x-full");
        overlay.classList.toggle("hidden");
    });

    overlay.addEventListener("click", () => {
        sidebar.classList.add("-translate-x-full");
        overlay.classList.add("hidden");
    });
</script>
